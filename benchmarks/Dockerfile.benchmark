FROM python:3.9-slim

# Install required system dependencies
RUN apt-get update && apt-get install -y \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# Copy only the necessary files from your local vLLM repository
WORKDIR /vllm
COPY . .

# Install only the required packages for benchmark_serving.py
RUN pip install \
    numpy==1.24.3 \
    datasets==2.16.1 \
    pillow==10.2.0 \
    tqdm==4.66.2 \
    transformers==4.37.2 \
    aiohttp==3.10.10

# Make the benchmark script the entrypoint
ENTRYPOINT ["python3", "benchmarks/benchmark_serving.py"]

# Default arguments that can be overridden
CMD ["--help"]